generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// This lets the AI look up prices instead of guessing.
model Product {
  id    String @id @default(uuid())
  name  String
  price Float

  // Link to the Shopkeeper (Clerk User ID)
  userId String
  user   User   @relation(fields: [userId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Index for faster lookups by user
  @@index([userId])
}

// üßæ INVOICE HISTORY
model Invoice {
  id            String  @id @default(uuid())
  invoiceNumber String
  customerName  String
  customerPhone String?
  totalAmount   Float
  status        String  @default("PAID") // Options: "PAID", "UNPAID"

  // JSON String of items: [{ "desc": "Samosa", "qty": 2, ... }]
  items     Json
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())

  @@index([userId])
}

model User {
  id          String  @id @default(cuid())
  clerkUserId String  @unique
  phone       String  @unique // ‚Üê IMPORTANT
  email       String?
  name        String?

  products Product[]
  invoices Invoice[]
}

model ProcessedMessage {
  id        String   @id
  createdAt DateTime @default(now())
}
